近日 Oracle 数据库 比特 币 勒索 病毒 卷土重来 国内 发生 案例 攻击 启明星 辰 数据库安全 审计 防护 产品 提供 检测 防护 具体 安全 建议 Oracle 勒索 病毒 分析 勒索 代码 捆绑 OraclePL / SQLDev 软件 中 ( 网络 下载版 ) 里面 一个 脚本 文件 Afterconnet . sql 黑客 注入 病毒 代码 用户 使用 PL / SQLDev 工具 连接 数据库 会 立即 执行 Afterconnet . sql 创建 四个 存储 过程 ( DBMS SUPPORT INTERNAL DBMS SYSTEM INTERNAL DBMS CORE INTERNAL DBMS STANDARD FUN9 ) 三个 触发器 ( DBMS SUPPORT INTERNAL DBMS SYSTEM INTERNAL DBMS CORE INTERNAL ) 病毒 读取 数据库 创建 时间 大于 等于 1200 天 数据库 进行 不同 程度 破坏 ( Truncatetab name 删除 tab 中 记录 ) 重启 数据库 会 导致用户 无法访问 数据库 对象 给出 提示 数据库 已经 SQLRUSHTeam 锁死 请 发送 比特 币到 xxxxxxxxxxx 地址 … . 信息 设置 定时 任务 期限内 交 赎金 删除 表 具体 提示信息 防护 方案 利用 数据库安全 审计 防护 产品 发现异常 进行 防护 部署 启明星 辰 数据库 审计 数据库 防火墙 用户 自行添加 勒索 病毒 审计 策略 主要 规则 权限 最小化 限制 不同 用户 角色 给予 最小 权限 低 权限 用户 限制 触发器 存储 过程 创建 修改 策略 配置 低 权限 用户 配置 一个 权限 控制 集合 触发器 存储 过程 新建 修改 删除 操作 执行 进行 告警 阻断 勒索 病毒 精准 控制 恶意 存储 过程 触发器 创建 行为 限制 高 权限 账号 新建 恶意 存储 过程 操作 定义 规则 建立 阻断 策略 进行 限制 如图 依次 创建 四个 存储 过程 DBMS SUPPORT INTERNAL DBMS SYSTEM INTERNAL DBMS CORE INTERNAL DBMS STANDARD FUN9 三个 触发器 DBMS SUPPORT INTERNAL DBMS SYSTEM INTERNAL DBMS CORE INTERNAL 检测 规则 操作 规则 建立 审计 阻断 策略 病毒 变种 需要 加强 PL / SQLDev 客户端 操作 监管 定义 规则 客户端 工具 PL / SQL 操作 进行 记录 存储 过程 触发器 操作 进行 告警 如图 建立 规则 依次 选择 对应 响应 方式 建立 审计 策略 人工 确认 病毒 入侵 痕迹 及时 清理 恶意 文件 检查 启动 脚本 大多数 客户端 工具 访问 数据库 时 脚本 进行 一定 功能 定义 脚本 往往 安全 问题 漏洞 以下 列出 常见 客户端 工具 脚本 位置 需要 检查 脚本 是否 正常 plsqldev login . sql afterconnect . sql Toad toad . ini sqlplus 中 glogin . sql login . sql 数据库 中 执行 检查 语句 Select * fromdba triggerswhereTRIGGER NAMElike ' DBMS _%_ INTERNAL% ' ; selectfromdba proceduresWwhereW . object namelike ' DBMS _%_ INTERNAL% ' 操作 发现异常 立刻 清理 恶意 文件 删除 已经 建立 存储 过程 触发器 综上 Oracle 比特 币 勒索 病毒 防护 方案 防护 工具 合理 使用 有赖于 数据库 管理人员 安全 防范 意识 建议 用户 使用 正版软件 做好 数据库 访问控制 权限 管理 异常 IP 账号 客户端 访问 及时 处置 关闭 病毒感染 通道 发现 病毒感染 请 及时 采取措施 必要 时 咨询 专业 安全 服务 团队 寻求 支持 （ 一鸣 ） [ 责编 战钊 ] 